# Project2：基于数字水印的图片泄露检测系统


## 1. 引言
数字水印（Digital Watermarking）是一种将附加信息嵌入到数字媒体（图像、音频、视频等）中的技术，广泛应用于版权保护、信息认证、防泄露追踪等领域。  
本实验实现了**基于 DCT 的图像盲水印嵌入与提取算法**，并通过多种攻击手段（亮度调整、对比度调整、噪声、旋转、裁剪）测试水印的鲁棒性。  
**盲水印**（Blind Watermark）指的是在提取水印时**不需要原始图片**，仅依赖嵌入规则即可恢复水印信息。

---

## 2. 算法原理

### 2.1 DCT 基本原理
二维离散余弦变换（2D Discrete Cosine Transform, DCT）定义为：
\[
F(u, v) = \frac{2}{N} C(u) C(v) \sum_{x=0}^{N-1} \sum_{y=0}^{N-1} 
f(x, y) \cos\left[\frac{(2x+1)u\pi}{2N}\right] \cos\left[\frac{(2y+1)v\pi}{2N}\right]
\]
其中：
\[
C(w) = 
\begin{cases}
\frac{1}{\sqrt{2}}, & w = 0 \\
1, & w \neq 0
\end{cases}
\]
- **低频系数**：位于左上角，表示图像整体亮度  
- **高频系数**：位于右下角，表示图像细节与噪声  
- **中频系数**：介于两者之间，适合嵌入水印（平衡不可见性与鲁棒性）

---

### 2.2 嵌入原理
1. 将图像转换为 YCbCr 颜色空间，仅在亮度通道 (Y) 中嵌入水印。  
2. 将亮度通道分成 8×8 块，对每块做 DCT。  
3. 选取两个中频系数位置（如 $(u_1, v_1)$ 和 $(u_2, v_2)$）。  
4. 对应水印比特：
   - 若比特为 1，则调整系数使 $F(u_1, v_1) > F(u_2, v_2)$
   - 若比特为 0，则调整系数使 $F(u_1, v_1) < F(u_2, v_2)$  
5. 对所有块逆 DCT（IDCT）重建图像。

---

### 2.3 提取原理
1. 将含水印图片转换为 YCbCr 并分块 DCT。  
2. 对比 $(u_1, v_1)$ 与 $(u_2, v_2)$：
   - 若 $F(u_1, v_1) > F(u_2, v_2)$，判定为比特 1  
   - 否则为比特 0  
3. 将提取的比特流还原为字符序列。

---

## 3. 实现思路

1. **盲提取设计**  
   不依赖原图提取水印，只需保证嵌入和提取时系数位置一致。  

2. **鲁棒性测试模块**  
   通过 OpenCV 对水印图像施加攻击：
   - 对比度调整  
   - 亮度调整  
   - 高斯噪声  
   - 旋转  
   - 裁剪  

3. **正确率计算**  
   设原水印为 $W$，提取结果为 $\hat{W}$，则正确率：
   \[
   \text{Accuracy} = \frac{\text{匹配字符数}}{\text{总字符数}} \times 100\%
   \]

---

## 4. 实验过程

### 4.1 环境依赖
```bash
pip install opencv-python numpy

pip install opencv-python numpy pillow scikit-image matplotlib
